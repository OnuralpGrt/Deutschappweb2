const translations = {
    tr: {
        'nav-home': 'Ana Sayfa',
        'nav-features': 'Özellikler',
        'nav-projects': 'Projeler',
        'nav-about': 'Hakkımızda',
        'nav-contact': 'İletişim',
        'nav-ubung': 'Çalışma',
        'nav-game': 'Oyun',
        'hero-title': 'Almanca Öğrenmeyi Yeniden Keşfedin',
        'hero-subtitle': 'Deutschapp ile Almanca öğrenmek artık çok daha kolay ve eğlenceli. Kişiselleştirilmiş öğrenme deneyimi, interaktif alıştırmalar ve profesyonel eğitmenlerle birlikte dil seviyenizi hızlıca geliştirin.',
        'ubung-title': 'Almanca Çalışma',
        'ubung-subtitle': 'Almanca bilginizi test edin ve geliştirin',
        'professional-badge': 'Profesyonel Dil Eğitimi',
        'features-btn': 'ÖZELLİKLERİ KEŞFET',
        'projects-btn': 'PROJELERİMİZ',
        'projects-title': 'Projelerimiz',
        'project1-title': 'Web Uygulaması',
        'project1-desc': 'Her yerden erişilebilen web uygulamamızla Almanca öğrenin. Çevrimiçi ve çevrimdışı mod desteği ile her zaman öğrenmeye devam edin.',
        'project2-title': 'AI Destekli Öğrenme',
        'project2-desc': 'Yapay zeka ile kişiselleştirilmiş öğrenme deneyimi',
        'project3-title': 'Video Dersler',
        'project3-desc': 'Profesyonel eğitmenlerle hazırlanmış video içerikler',
        'about-title': 'Hakkımızda',
        'about-desc': 'DeutschApp, 2020 yılından bu yana Almanca öğrenmek isteyenler için yenilikçi çözümler sunmaktadır. Amacımız, teknolojiyi kullanarak dil öğrenmeyi daha etkili ve eğlenceli hale getirmektir.',
        'about-feature1': 'Uzman Eğitmen Kadrosu',
        'about-feature2': 'Sürekli Güncellenen İçerik',
        'about-feature3': '7/24 Destek',
        'why-us-title': 'Neden Biz?',
        'why-us1-title': 'Hızlı Öğrenme',
        'why-us1-desc': 'Etkili öğrenme yöntemleriyle hızlı sonuçlar',
        'why-us2-title': 'Akıllı Sistem',
        'why-us2-desc': 'Yapay zeka destekli kişiselleştirilmiş öğrenme',
        'why-us3-title': 'Esnek Program',
        'why-us3-desc': 'Kendi hızınızda öğrenme imkanı',
        'footer-desc': 'Almanca öğrenmenin en kolay yolu',
        'footer-links': 'Hızlı Bağlantılar',
        'footer-home': 'Ana Sayfa',
        'footer-projects': 'Projeler',
        'footer-about': 'Hakkımızda',
        'footer-contact': 'İletişim',
        'footer-social': 'Sosyal Medya',
        'footer-text': '© 2024 DeutschApp. Tüm hakları saklıdır.',
        'contact-title': 'İletişim Formu',
        'contact-name-placeholder': 'Adınız',
        'contact-email-placeholder': 'E-posta',
        'contact-message-placeholder': 'Mesajınız',
        'contact-submit': 'Gönder'
    },
    en: {
        'nav-home': 'Home',
        'nav-features': 'Features',
        'nav-projects': 'Projects',
        'nav-about': 'About',
        'nav-contact': 'Contact',
        'nav-ubung': 'Study',
        'nav-game': 'Game',
        'hero-title': 'Rediscover Learning German',
        'hero-subtitle': 'Learning German is now much easier and more fun with Deutschapp. Quickly improve your language level with personalized learning experience, interactive exercises, and professional instructors.',
        'ubung-title': 'German Study',
        'ubung-subtitle': 'Test and improve your German knowledge',
        'professional-badge': 'Professional Language Education',
        'features-btn': 'DISCOVER FEATURES',
        'projects-btn': 'OUR PROJECTS',
        'stat-users': '10,000+',
        'stat-users-text': 'Active Users',
        'stat-rating': '4.8/5',
        'stat-rating-text': 'User Rating',
        'stat-lessons': '500+',
        'stat-lessons-text': 'Lesson Content',
        'projects-title': 'Our Projects',
        'project1-title': 'Web App',
        'project1-desc': 'A user-friendly web app interface compatible with iOS and Android',
        'project2-title': 'AI-Powered Learning',
        'project2-desc': 'Personalized learning experience with artificial intelligence',
        'project3-title': 'Video Lessons',
        'project3-desc': 'Video content prepared by professional instructors',
        'about-title': 'About Us',
        'about-desc': 'Since 2020, DeutschApp has been providing innovative solutions for those who want to learn German. Our goal is to make language learning more effective and fun using technology.',
        'about-feature1': 'Expert Teaching Staff',
        'about-feature2': 'Regularly Updated Content',
        'about-feature3': '24/7 Support',
        'why-us-title': 'Why Choose Us?',
        'why-us1-title': 'Fast Learning',
        'why-us1-desc': 'Quick results with effective learning methods',
        'why-us2-title': 'Smart System',
        'why-us2-desc': 'Personalized learning with artificial intelligence',
        'why-us3-title': 'Flexible Schedule',
        'why-us3-desc': 'Learn at your own pace',
        'footer-desc': 'The easiest way to learn German',
        'footer-links': 'Quick Links',
        'footer-home': 'Home',
        'footer-projects': 'Projects',
        'footer-about': 'About',
        'footer-contact': 'Contact',
        'footer-social': 'Social Media',
        'footer-text': '© 2024 DeutschApp. All rights reserved.',
        'discover-btn': 'Discover',
        'contact-btn': 'Contact Us',
        'contact-title': 'Contact Form',
        'contact-name-placeholder': 'Your Name',
        'contact-email-placeholder': 'Email',
        'contact-message-placeholder': 'Your Message',
        'contact-submit': 'Submit'
    },
    de: {
        'nav-home': 'Startseite',
        'nav-features': 'Funktionen',
        'nav-projects': 'Projekte',
        'nav-about': 'Über uns',
        'nav-contact': 'Kontakt',
        'nav-ubung': 'Übung',
        'nav-game': 'Spiel',
        'hero-title': 'Entdecken Sie Deutsch Lernen Neu',
        'hero-subtitle': 'Deutsch lernen ist jetzt viel einfacher und macht mehr Spaß mit Deutschapp. Verbessern Sie Ihr Sprachniveau schnell mit personalisierten Lernerfahrungen, interaktiven Übungen und professionellen Lehrkräften.',
        'ubung-title': 'Deutsch Übung',
        'ubung-subtitle': 'Testen und verbessern Sie Ihre Deutschkenntnisse',
        'professional-badge': 'Professioneller Sprachunterricht',
        'features-btn': 'FUNKTIONEN ENTDECKEN',
        'projects-btn': 'UNSERE PROJEKTE',
        'stat-users': '10.000+',
        'stat-users-text': 'Aktive Nutzer',
        'stat-rating': '4,8/5',
        'stat-rating-text': 'Nutzerbewertung',
        'stat-lessons': '500+',
        'stat-lessons-text': 'Lerninhalte',
        'projects-title': 'Unsere Projekte',
        'project1-title': 'Web App',
        'project1-desc': 'Benutzerfreundliche Oberfläche für Webanwendungen',
        'project2-title': 'KI-gestütztes Lernen',
        'project2-desc': 'Personalisierte Lernerfahrung mit künstlicher Intelligenz',
        'project3-title': 'Video-Lektionen',
        'project3-desc': 'Von professionellen Lehrern erstellte Videoinhalte',
        'about-title': 'Über Uns',
        'about-desc': 'Seit 2020 bietet DeutschApp innovative Lösungen für alle, die Deutsch lernen möchten. Unser Ziel ist es, das Sprachenlernen durch Technologie effektiver und unterhaltsamer zu gestalten.',
        'about-feature1': 'Experten-Team',
        'about-feature2': 'Regelmäßig aktualisierte Inhalte',
        'about-feature3': '24/7 Support',
        'why-us-title': 'Warum Wir?',
        'why-us1-title': 'Schnelles Lernen',
        'why-us1-desc': 'Schnelle Ergebnisse durch effektive Lernmethoden',
        'why-us2-title': 'Intelligentes System',
        'why-us2-desc': 'Personalisierte Lerninhalte mit KI',
        'why-us3-title': 'Flexibler Zeitplan',
        'why-us3-desc': 'Lernen Sie in Ihrem eigenen Tempo',
        'footer-desc': 'Der einfachste Weg, Deutsch zu lernen',
        'footer-links': 'Schnellzugriff',
        'footer-home': 'Startseite',
        'footer-projects': 'Projekte',
        'footer-about': 'Über Uns',
        'footer-contact': 'Kontakt',
        'footer-social': 'Soziale Medien',
        'footer-text': '© 2024 DeutschApp. Alle Rechte vorbehalten.',
        'discover-btn': 'Entdecken',
        'contact-btn': 'Kontakt',
        'contact-title': 'Kontaktformular',
        'contact-name-placeholder': 'Ihr Name',
        'contact-email-placeholder': 'E-Mail',
        'contact-message-placeholder': 'Ihre Nachricht',
        'contact-submit': 'Senden'
    }
};

// Aktif dili saklamak için
let currentLang = 'tr';

// Dil değiştirme fonksiyonu
function changeLanguage(lang) {
    currentLang = lang;
    document.documentElement.lang = lang;
    
    // Tüm çevrilebilir elementleri bul ve çevir
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[lang][key];
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });

    // Özel elementleri çevir
    const heroTitle = document.querySelector('.hero h1');
    if (heroTitle) heroTitle.textContent = translations[lang]['hero-title'];

    const heroSubtitle = document.querySelector('.hero p');
    if (heroSubtitle) heroSubtitle.textContent = translations[lang]['hero-subtitle'];

    const badge = document.querySelector('.badge');
    if (badge) badge.textContent = translations[lang]['professional-badge'];

    const featuresBtn = document.querySelector('.primary-btn');
    if (featuresBtn) featuresBtn.textContent = translations[lang]['features-btn'];

    const projectsBtn = document.querySelector('.secondary-btn');
    if (projectsBtn) projectsBtn.textContent = translations[lang]['projects-btn'];

    const projectsTitle = document.querySelector('.projects h2');
    if (projectsTitle) projectsTitle.textContent = translations[lang]['projects-title'];

    // Proje kartlarını çevir
    const projectCards = document.querySelectorAll('.project-card');
    projectCards.forEach((card, index) => {
        const title = card.querySelector('h3');
        const desc = card.querySelector('p');
        if (title) title.textContent = translations[lang][`project${index + 1}-title`];
        if (desc) desc.textContent = translations[lang][`project${index + 1}-desc`];
    });

    // Hakkımızda bölümünü çevir
    const aboutTitle = document.querySelector('.about h2');
    if (aboutTitle) aboutTitle.textContent = translations[lang]['about-title'];

    const aboutDesc = document.querySelector('.about-text p');
    if (aboutDesc) aboutDesc.textContent = translations[lang]['about-desc'];

    const aboutFeatures = document.querySelectorAll('.about-feature span');
    aboutFeatures.forEach((feature, index) => {
        feature.textContent = translations[lang][`about-feature${index + 1}`];
    });

    // Neden Biz bölümünü çevir
    const whyUsTitle = document.querySelector('.why-us h2');
    if (whyUsTitle) whyUsTitle.textContent = translations[lang]['why-us-title'];

    const whyUsCards = document.querySelectorAll('.why-us-card');
    whyUsCards.forEach((card, index) => {
        const title = card.querySelector('h3');
        const desc = card.querySelector('p');
        if (title) title.textContent = translations[lang][`why-us${index + 1}-title`];
        if (desc) desc.textContent = translations[lang][`why-us${index + 1}-desc`];
    });

    // İletişim bölümünü çevir
    const contactTitle = document.querySelector('.contact h2');
    if (contactTitle) contactTitle.textContent = translations[lang]['contact-title'];

    const contactInputs = {
        name: document.querySelector('input[data-translate="contact-name-placeholder"]'),
        email: document.querySelector('input[data-translate="contact-email-placeholder"]'),
        message: document.querySelector('textarea[data-translate="contact-message-placeholder"]')
    };

    if (contactInputs.name) contactInputs.name.placeholder = translations[lang]['contact-name-placeholder'];
    if (contactInputs.email) contactInputs.email.placeholder = translations[lang]['contact-email-placeholder'];
    if (contactInputs.message) contactInputs.message.placeholder = translations[lang]['contact-message-placeholder'];

    const submitBtn = document.querySelector('.contact-form button');
    if (submitBtn) submitBtn.textContent = translations[lang]['contact-submit'];

    // Footer bölümünü çevir
    const footerDesc = document.querySelector('.footer-section p[data-translate="footer-desc"]');
    if (footerDesc) footerDesc.textContent = translations[lang]['footer-desc'];

    const footerLinks = document.querySelector('.footer-section h3[data-translate="footer-links"]');
    if (footerLinks) footerLinks.textContent = translations[lang]['footer-links'];

    const footerSocial = document.querySelector('.footer-section h3[data-translate="footer-social"]');
    if (footerSocial) footerSocial.textContent = translations[lang]['footer-social'];

    const footerText = document.querySelector('.footer-bottom p[data-translate="footer-text"]');
    if (footerText) footerText.textContent = translations[lang]['footer-text'];

    // Footer linkleri çevir
    const footerNavLinks = {
        home: document.querySelector('a[data-translate="footer-home"]'),
        projects: document.querySelector('a[data-translate="footer-projects"]'),
        about: document.querySelector('a[data-translate="footer-about"]'),
        contact: document.querySelector('a[data-translate="footer-contact"]')
    };

    if (footerNavLinks.home) footerNavLinks.home.textContent = translations[lang]['footer-home'];
    if (footerNavLinks.projects) footerNavLinks.projects.textContent = translations[lang]['footer-projects'];
    if (footerNavLinks.about) footerNavLinks.about.textContent = translations[lang]['footer-about'];
    if (footerNavLinks.contact) footerNavLinks.contact.textContent = translations[lang]['footer-contact'];

    // Local storage'a kaydet
    localStorage.setItem('preferredLanguage', lang);
}

// Test Soruları ve Fonksiyonları
const questions = [
    {
        question: "Was hat Johannes Gutenberg erfunden?",
        options: ["Druckmaschine", "Buchdruck", "Drucker"],
        correct: 1
    },
    {
        question: "Wann wurde Neptun entdeckt?",
        options: ["1846", "1746", "1906"],
        correct: 0
    },
    {
        question: "Was hat Elon Musk studiert?",
        options: ["Ingeniuerwissenschaften", "Wirtschaftswissenschaften", "Naturwissenschaften"],
        correct: 1
    },
    {
        question: "Wann wurde die Berliner Mauer gebaut?",
        options: ["1945", "1955", "1961"],
        correct: 2
    },
    {
        question: "Woraus besteht die Dubai-Schokolade?",
        options: ["Nougatcreme und Vollmilchschokolade", "Pistaziencreme und Vollmilchschokolade", "Pralinen"],
        correct: 1
    },
    {
        question: "Wieviele Kompositionen hat Mozart gemacht?",
        options: ["6000", "600", "über 600"],
        correct: 2
    },
    {
        question: "Welches Land hat die Spitzenposition bei Patenten in Europa?",
        options: ["England", "Deutschland", "Russland"],
        correct: 1
    },
    {
        question: "Welche Energiequelle wird als die größte Energiequelle bezeichnet?",
        options: ["Erdöl", "Wasserkraft", "Sonnenenergie"],
        correct: 2
    },
    {
        question: "Welche Sprache ist für die Deutschen die Schwierigste zum Erlernen?",
        options: ["Chinesisch", "Polnisch", "Japanisch"],
        correct: 0
    },
    {
        question: "Ab wann kann man den Führerschein in Deutschland machen?",
        options: ["mit 18", "drei Monate vor dem 17. Geburtstag", "mit 17"],
        correct: 1
    }
];

let currentQuestion = 0;
let userAnswers = new Array(questions.length).fill(null);
let isQuizCompleted = false;

function initializeQuiz() {
    displayQuestion();
    updateProgress();
    updateButtons();
}

function displayQuestion() {
    const container = document.getElementById('questions-container');
    container.innerHTML = '';
    
    const question = questions[currentQuestion];
    const questionHTML = `
        <div class="question-container">
            <div class="question-text">${question.question}</div>
            <div class="options-container">
                ${question.options.map((option, index) => `
                    <div class="option ${userAnswers[currentQuestion] === index ? 'selected' : ''} 
                         ${isQuizCompleted ? (index === question.correct ? 'correct' : 
                         (userAnswers[currentQuestion] === index && index !== question.correct ? 'incorrect' : '')) : ''}">
                        <input type="radio" name="question${currentQuestion}" id="option${index}" 
                               ${userAnswers[currentQuestion] === index ? 'checked' : ''}>
                        <label for="option${index}">
                            <div class="option-circle"></div>
                            ${option}
                        </label>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    container.innerHTML = questionHTML;
    
    if (!isQuizCompleted) {
        document.querySelectorAll('.option').forEach((option, index) => {
            option.addEventListener('click', () => selectOption(index));
        });
    }
}

function selectOption(index) {
    userAnswers[currentQuestion] = index;
    displayQuestion();
    updateButtons();
}

function updateProgress() {
    const progressBar = document.querySelector('.progress');
    const progress = ((currentQuestion + 1) / questions.length) * 100;
    if (progressBar) {
        progressBar.style.width = `${progress}%`;
    }
}

function updateButtons() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');

    if (prevBtn && nextBtn && submitBtn) {
        prevBtn.disabled = currentQuestion === 0;
        
        if (currentQuestion === questions.length - 1) {
            nextBtn.style.display = 'none';
            submitBtn.style.display = 'block';
        } else {
            nextBtn.style.display = 'block';
            submitBtn.style.display = 'none';
        }
    }
}

function showResults() {
    isQuizCompleted = true;
    const scoreDisplay = document.getElementById('score-display');
    const correctAnswers = userAnswers.reduce((total, answer, index) => {
        return total + (answer === questions[index].correct ? 1 : 0);
    }, 0);
    
    const score = Math.round((correctAnswers / questions.length) * 100);
    
    if (scoreDisplay) {
        scoreDisplay.innerHTML = `
            <h3>Testergebnisse</h3>
            <p>Gesamtfragen: ${questions.length}</p>
            <p>Richtige Antworten: ${correctAnswers}</p>
            <p>Erfolgsquote: ${score}%</p>
        `;
        scoreDisplay.style.display = 'block';
    }

    displayQuestion();
    
    const prevBtn = document.getElementById('prev-btn');
    const submitBtn = document.getElementById('submit-btn');
    
    if (prevBtn && submitBtn) {
        prevBtn.style.display = 'none';
        submitBtn.style.display = 'none';
    }
}

// Event Listeners
document.getElementById('prev-btn').addEventListener('click', () => {
    if (currentQuestion > 0) {
        currentQuestion--;
        displayQuestion();
        updateProgress();
        updateButtons();
    }
});

document.getElementById('next-btn').addEventListener('click', () => {
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        displayQuestion();
        updateProgress();
        updateButtons();
    }
});

document.getElementById('submit-btn').addEventListener('click', showResults);

// Sayfa yüklendiğinde
document.addEventListener('DOMContentLoaded', () => {
    // Ana sayfadaki Übung linkini kontrol et
    const ubungLink = document.querySelector('a[href="ubung.html"]');
    if (ubungLink) {
        ubungLink.addEventListener('click', (e) => {
            e.preventDefault();
            window.location.href = 'ubung.html';
        });
    }

    // Eğer ubung.html sayfasındaysak testi başlat
    if (window.location.pathname.includes('ubung.html')) {
        initializeQuiz();
    }

    // Smooth scroll ve dil değiştirme işlemleri
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Dil butonlarına event listener ekle
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const lang = btn.getAttribute('data-lang');
            changeLanguage(lang);
        });
    });

    // Kaydedilmiş dil tercihini kontrol et
    const savedLang = localStorage.getItem('preferredLanguage');
    if (savedLang) {
        changeLanguage(savedLang);
    }
}); 